<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head', { title }) %>

    <body>
        <%- include('../partials/header') %>

            <main class="container player-container">
                <!-- Video Player Section -->
                <!-- Video Player Section -->
                <section class="player-section">
                    <h1 class="video-title">
                        <%= video.title %>
                    </h1>
                    <div class="video-wrapper">
                        <video id="videoPlayer" class="plyr" playsinline controls data-video-id="<%= video.id %>"
                            data-saved-position="<%= video.position %>">
                            <source src="/api/videos/<%= video.id %>/stream" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>

                    <!-- Navigation -->
                    <div class="player-nav">
                        <% if (adjacent.prev) { %>
                            <a href="/video/<%= adjacent.prev %>" class="nav-button prev">
                                ‚Üê Previous
                            </a>
                            <% } else { %>
                                <span class="nav-button disabled">‚Üê Previous</span>
                                <% } %>

                                    <a href="/" class="nav-button home">üìö Back to Course</a>

                                    <% if (adjacent.next) { %>
                                        <a href="/video/<%= adjacent.next %>" class="nav-button next">
                                            Next ‚Üí
                                        </a>
                                        <% } else { %>
                                            <span class="nav-button disabled">Next ‚Üí</span>
                                            <% } %>
                    </div>
                </section>

                <!-- Video Info Section -->
                <section class="video-info-section">

                    <!-- Status Controls -->
                    <div class="status-controls">
                        <span class="status-label">Status:</span>
                        <div class="status-buttons">
                            <button class="status-btn <%= video.status === 'unwatched' ? 'active' : '' %>"
                                data-status="unwatched">
                                ‚óã Unwatched
                            </button>
                            <button class="status-btn <%= video.status === 'in-progress' ? 'active' : '' %>"
                                data-status="in-progress">
                                ‚ñ∂ In Progress
                            </button>
                            <button class="status-btn <%= video.status === 'completed' ? 'active' : '' %>"
                                data-status="completed">
                                ‚úì Completed
                            </button>
                        </div>
                    </div>

                    <!-- Keyboard Shortcuts Help -->
                    <details class="shortcuts-help">
                        <summary>‚å®Ô∏è Keyboard Shortcuts</summary>
                        <div class="shortcuts-grid">
                            <div class="shortcut"><kbd>Space</kbd> / <kbd>K</kbd> Play/Pause</div>
                            <div class="shortcut"><kbd>M</kbd> Mute/Unmute</div>
                            <div class="shortcut"><kbd>F</kbd> Fullscreen</div>
                            <div class="shortcut"><kbd>‚Üê</kbd> Back 10s</div>
                            <div class="shortcut"><kbd>‚Üí</kbd> Forward 10s</div>
                            <div class="shortcut"><kbd>‚Üë</kbd> Volume Up</div>
                            <div class="shortcut"><kbd>‚Üì</kbd> Volume Down</div>
                            <div class="shortcut"><kbd>C</kbd> Captions</div>
                        </div>
                    </details>
                </section>

                <!-- Notes Section -->
                <section class="notes-section">
                    <h2 class="section-title">üìù Notes</h2>
                    <textarea id="notesEditor" class="notes-editor"
                        placeholder="Take notes for this video... (Markdown supported)"><%= notes.content || '' %></textarea>
                    <div class="notes-actions">
                        <button id="saveNotes" class="btn btn-primary">Save Notes</button>
                        <span id="notesSaveStatus" class="save-status"></span>
                    </div>
                </section>
            </main>

            <%- include('../partials/footer') %>

                <link rel="stylesheet" href="/lib/plyr/plyr.css" />
                <script src="/lib/plyr/plyr.js"></script>
                <script src="/static/js/player.js"></script>
    </body>

</html>